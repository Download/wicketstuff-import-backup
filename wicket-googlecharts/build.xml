<?xml version="1.0" encoding="UTF-8"?>

<project name="wicket-googlecharts" default="build" basedir=".">
	<property file="build.properties"/>
	
	
	<target name="init">
		<mkdir dir="bin"/>
	</target>
	
	<target name="init-dist">
		<mkdir dir="dist/wicket-googlecharts-${wicket-googlecharts.version}/src"/>
	</target>
	
	<target name="build" depends="init">
		<javac srcdir="src" destdir="bin" classpath="${build.classpath}" source="1.5" 
			target="1.5" debug="${build.debug}"/>
	</target>
	
	<target name="jar">
		<!-- done as a antcall(s) rather than dependencies to ensure ordering -->
		<antcall target="clean"/>
		<antcall target="build"/>
		
		<jar basedir="bin" compress="${jar.compress}" 
				destfile="dist/wicket-googlecharts-${wicket-googlecharts.version}/wicket-googlecharts-${wicket-googlecharts.version}.jar"/>
	</target>
	
	<target name="dist" depends="init-dist,jar">
		<copy todir="dist/wicket-googlecharts-${wicket-googlecharts.version}/src">
			<fileset dir="src">
				<include name="**/*.java"/>
			</fileset>
		</copy>
		
		<zip destfile="dist/wicket-googlecharts-${wicket-googlecharts.version}.zip">
			<fileset id="productDir" dir="dist">
				<include name="wicket-googlecharts-${wicket-googlecharts.version}/**/*"/>
			</fileset>
		</zip>
		
		<tar destfile="dist/wicket-googlecharts-${wicket-googlecharts.version}.tar">
			<fileset refid="productDir"/>
		</tar>
		<gzip src="dist/wicket-googlecharts-${wicket-googlecharts.version}.tar" 
				zipfile="dist/wicket-googlecharts-${wicket-googlecharts.version}.tar.gz"/>
		<delete file="dist/wicket-googlecharts-${wicket-googlecharts.version}.tar"/>
		
		<delete includeemptydirs="yes">
			<fileset dir="dist">
				<include name="wicket-googlecharts-${wicket-googlecharts.version}/**/*"/>
			</fileset>
		</delete>
		<delete includeemptydirs="yes">
			<fileset dir="dist">
				<include name="wicket-googlecharts-${wicket-googlecharts.version}"/>
			</fileset>
		</delete>
	</target>

	<target name="clean">
		<delete dir="bin"/>
	</target>
	
	<target name="clean-dist">
		<delete dir="dist"/>
	</target>
</project>